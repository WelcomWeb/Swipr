/**
* Swipr 1.1
*
* A responsive, mobile friendly, javascript and CSS3 slider
*
* @author Björn Wikström <bjorn@welcom.se>
* @license LGPL v3 <http://www.gnu.org/licenses/lgpl.html>
* @version 1.1
* @copyright Welcom Web i Göteborg AB 2013
*/
;(function(e,t,n,r){if(typeof e.Swipr!==typeof r){return}var i=function(i,s){this.options=n.extend({auto:0,speed:500,resizable:true,startAt:0,selector:".swipe-item",onSwipeStart:function(){},onSwipeEnd:function(){}},s);this.$container=n(i);this.$items=n(this.options.selector,i);this._index=this.options.startAt||0;this._intervalId=0;var o=-1,u=1;var a=function(){return e.navigator.msPointerEnabled?"MSPointerDown":"touchstart"}(),f=function(){return e.navigator.msPointerEnabled?"MSPointerMove":"touchmove"}(),l=function(){return e.navigator.msPointerEnabled?"MSPointerUp":"touchend"}();this.has=function(){return{touch:!!function(){return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||e.navigator.msMaxTouchPoints}(),transitions:!!function(){var e=t.createElement("div").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e}()}}();this.next=function(){if(this._index===this.$items.length-1){this._index=0}else{this._index++}this.slideTo(this._index)};this.prev=function(){if(this._index===0){this._index=this.$items.length-1}else{this._index--}this.slideTo(this._index)};this.index=function(){return this._index};this.stop=function(){clearInterval(this._intervalId)};this.restart=function(){if(this.options.auto){var e=this;this._intervalId=setInterval(function(){e.next()},this.options.auto)}};var c=function(e,t){var n=this.$movable.position().left;var r=this.$movable.get(0).style;r.webkitTransitionDuration=r.MozTransitionDuration=r.msTransitionDuration=r.OTransitionDuration=r.transitionDuration="0ms";r.webkitTransform="translate3d("+(n+(t-e))+"px,0,0)";r.msTransform=r.MozTransform=r.OTransform="translateX("+(n+(t-e))+"px)"};this.slideTo=function(e,t,n){e=e>=0?e:0;e=e<this.$items.length?e:this.$items.length-1;this.options.onSwipeStart.call(this,e);this._index=e;var r=this.$movable.get(0).style,i=-1*this.$container.width()*e;t=t||this.options.speed;var s=this;setTimeout(function(){s.options.onSwipeEnd.call(s,e)},t);if(!this.has.transitions||n){h.call(this,i,t,e);return}r.webkitTransitionDuration=r.MozTransitionDuration=r.msTransitionDuration=r.OTransitionDuration=r.transitionDuration=t+"ms";r.webkitTransform="translate3d("+i+"px,0,0)";r.msTransform=r.MozTransform=r.OTransform="translateX("+i+"px)"};var h=function(e,t,n){var r=this;this.$movable.animate({left:e+"px"},t)};var p=this;var d=function(e){this._x=e.touches?e.touches[0].pageX:e.pageX;this._y=e.touches?e.touches[0].pageY:e.pageY;this._scroll=false;this._direction=r;this._reset=false;this._offset=p.$movable.offset().left;this._timeId=0};var v=function(t){if(t.touches&&t.touches.length>1){return}var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY;if(!this._scroll&&Math.abs(Math.abs(this._y)-Math.abs(r))>Math.abs(Math.abs(this._x)-Math.abs(n))){return}t.preventDefault();p.stop();this._scroll=true;this._direction=this._x<n?u:o;if(e.navigator.msPointerEnabled&&(n<p.$container.offset().left||n>p.$container.offset().left+p.$container.width())){m.call(this,null,true)}c.call(p,this._x,n);this._x=n};var m=function(e,t){if(this._scroll){p._index-=this._direction;if(p._index>p.$items.length-1){p._index=p.$items.length-1}if(p._index<1){p._index=0}p.slideTo(p._index,100,!!t)}};var g=function(){this.$items.css({width:this.$container.width()+"px"});this.$movable.css({width:"99999px"});this._offset=this.$movable.offset().left};var y=function(){if(this.$items.length<2){return}var t=this;this.$movable=n('<div style="overflow: hidden; position: relative;"></div>');this.$items.appendTo(this.$movable.appendTo(t.$container));b.call(t);g.call(this);if(this.options.auto){this._intervalId=setInterval(function(){t.next()},this.options.auto)}if(this.options.resizable){var r=0;n(e).on("resize",function(){clearTimeout(r);r=setTimeout(function(){g.call(t);t.slideTo(t.index(),0)},50)})}};var b=function(){if(this.has.touch){if(e.navigator.msPointerEnabled){this.$container.css("-ms-touch-action","pan-y")}this.$container.get(0).addEventListener(a,d,false);this.$container.get(0).addEventListener(f,v,false);this.$container.get(0).addEventListener(l,m,false)}};y.call(this)};e.Swipr=i;n.fn.Swipr=function(e){n.each(this,function(){new i(this,e)})}})(window,window.document,jQuery)